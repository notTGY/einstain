# –ü—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π Petite-vue

–ü—Ä–∏–≤–µ—Ç üëã, —ç—Ç–æ —Å—Ç–∞—Ç—å—è –ø—Ä–æ progressive enchancement —Å –ø–æ–º–æ—â—å—é petite-vue. –¢—É—Ç —è —Ä–∞—Å—Å–∫–∞–∂—É –ø—Ä–æ –µ–≥–æ –ø—Ä–∏–∫–æ–ª—å–Ω—ã–µ —Ñ–∏—á–∏ (–∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞, —Ç–∞–∫ –∏ –≤ —Å–æ—Å—Ç–∞–≤–µ Vue). –ö–æ–Ω–µ—á–Ω–æ, –±—ã–ª–æ –±—ã –ø—Ä–∏–∫–æ–ª—å–Ω–æ, –µ—Å–ª–∏ –±—ã —Ç—ã –ø—Ä–æ—á–∏—Ç–∞–ª(–∞) [–ø—Ä–µ–¥—ã–¥—É—â—É—é —Å—Ç–∞—Ç—å—é –ø–æ Petite-vue](https://habr.com/ru/post/593877/), —Ç–∞–º –º–Ω–æ–≥–æ —á–µ–≥–æ —Ä–∞—Å–∫–∞–∑–∞–Ω–æ –ø—Ä–æ **–ª–∏–±—É** –≤ —Ü–µ–ª–æ–º, –µ—Å—Ç—å –∫–∞–∫–∏–µ-—Ç–æ –±–∞–∑–æ–≤—ã–µ –ø—Ä–∏–º–µ—Ä—ã, –Ω–æ "it's okay" –Ω–µ —á–∏—Ç–∞—Ç—å –µ—ë. –ï—Å–ª–∏ —Å–æ–æ–±—Ä–∞–∂–∞–µ—à—å —á—Ç–æ-—Ç–æ –≤–æ Vue - —Ç—É—Ç –Ω–µ —Ç–∞–∫ —É–∂ –∏ –º–Ω–æ–≥–æ –æ—Ç–ª–∏—á–∏–π (–æ –∫–æ—Ç–æ—Ä—ã—Ö, –ø–æ–º–∏–º–æ –ø—Ä–æ—á–µ–≥–æ, —Ç—É—Ç –∏ –ø–æ–π–¥—ë—Ç —Ä–µ—á—å).

–ù—É, —è –Ω–∞–¥–µ—é—Å—å —Ç—ã "ready to action", —Ç–∞–∫ —á—Ç–æ –¥–∞–≤–∞–π —Å—Ä–∞–∑—É –∑–∞–ø—Ä—ã–≥–Ω–µ–º –≤ –∫–æ–¥.

## –ü—Ä–æ—Å—Ç–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è progressive enchancement–∞

```html
<title> Petite Vue Progressive Enchancement </title>
<style>
  [v-cloak] {display:none}
  body { background: #fff!important }
</style>

<script src="https://unpkg.com/petite-vue" defer init></script>
<script>
  const SCRIPTS = [
    "https://ahfarmer.github.io/calculator/static/js/main.b319222a.js",
  ]
  const CSS = [
    "https://ahfarmer.github.io/calculator/static/css/main.b51b4a8b.css",
  ]

  function embedScript(mount, src) {
    const tag = document.createElement("script")
    tag.src = src
    return mount.appendChild(tag)
  }
  function embedCSS(mount, src) {
    const tag = document.createElement("link")
    tag.rel = "stylesheet"
    tag.href = src
    return mount.appendChild(tag)
  }
  function tryToLoadSPA() {
    setTimeout(loadSPA, 1000)
  }
  function loadSPA() {
    const mount = document.getElementsByTagName("head")[0]
    SCRIPTS.map(src => embedScript(mount, src))
    CSS.map(src => embedCSS(mount, src))
  }
</script>

<body>
  <div id="root" v-scope="{num: 0}" v-cloak @mounted="tryToLoadSPA">
    {{ num }} <button @click="num++">+</button>
  </div>
</body>
```
–¢—É—Ç, –Ω–∞–≤–µ—Ä–Ω–æ–µ, –æ—á–µ–Ω—å –º–Ω–æ–≥–æ –≤—Å–µ–≥–æ –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ–≥–æ. –ù–∞–≤–µ—Ä–Ω–æ–µ –ø–æ–º–æ–∂–µ—Ç –µ—Å–ª–∏ —Ç—ã –∑–∞–π–¥—ë—à—å —Å—Ä–∞–∑—É –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ [–≥–æ—Ç–æ–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ](https://nottgy.github.io/einstain/petite-vue-example/progressive-enchancement/naive.html), –ø–æ—Ç—ã–∫–∞–µ—à—å—Å—è.
–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ —Å—É—Ç–∏: –ø–æ–∫–∞ –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª—Å—è petite-vue - –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º, –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ petite-vue - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º *–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ-counter* –∏ —Å—Ç–∞–≤–∏–º –Ω–∞ –∑–∞–≥—Ä—É–∑–∫—É —Å—Ç–∏–ª–∏ –∏ —Å–∫—Ä–∏–ø—Ç—ã **–º–æ—â–Ω–æ–≥–æ** React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ N (=1) —Å–µ–∫—É–Ω–¥, –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è - petite-vue –ø—Ä–æ–ø–∞–¥–∞–µ—Ç.
–í –∫–∞—á–µ—Å—Ç–≤–µ –ø–æ–¥–æ–ø—ã—Ç–Ω–æ–≥–æ React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —è –≤–∑—è–ª (–ø–µ—Ä–≤–∞—è —Å—Å—ã–ª–∫–∞ –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ :)) [–≤–æ—Ç —ç—Ç–æ—Ç –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä](https://github.com/ahfarmer/calculator)

–¢–∞–∫, –Ω—É –∞ —Ç–µ–ø–µ—Ä—å –¥–∞–≤–∞–π —Ä–∞–∑–±–∏—Ä–∞—Ç—å—Å—è, —á—Ç–æ –∂–µ —Ç—É—Ç –Ω–∞–ø–∏—Å–∞–Ω–æ –∏ –∫–∞–∫ –º–æ–∂–Ω–æ —ç—Ç–æ —É–ª—É—á—à–∏—Ç—å.
```html
<style>
  [v-cloak] {display:none}
  body { background: #fff!important }
</style>
```
–ê—Ç—Ä–∏–±—É—Ç *v-cloak* –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–∫—Ä—ã–≤–∞—Ç—å —á–∞—Å—Ç—å –¥–µ—Ä–µ–≤–∞ –¥–æ –º–æ–º–µ–Ω—Ç–∞, –∫–æ–≥–¥–∞ petite-vue –µ—ë —Ä–∞—Å–ø–∞—Ä—Å–∏–ª. –ü–æ —Å—É—Ç–∏ –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å —Ç–∞–º –ª—é–±–æ–π —Å—Ç–∏–ª—å, –Ω–æ —Å–∞–º–æ–µ –ª–æ–≥–∏—á–Ω–æ–µ - —Å–∫—Ä—ã–≤–∞—Ç—å —ç–ª–µ–º–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ –æ–∂–∏–¥–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (—ç—Ç–∞ –¥–∏—Ä–µ–∫—Ç–∏–≤–∞ –µ—Å—Ç—å –∏ –≤ –æ–±—ã—á–Ω–æ–º Vue). –ï—â—ë —è –∑–∞–¥–∞–ª –±–µ–ª—ã–π –±—ç–∫–≥—Ä–∞—É–Ω–¥, —Ç–∞–∫ –∫–∞–∫ —Å—Ç–∏–ª–∏ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ –µ–≥–æ –º–µ–Ω—è—é—Ç, –∞ —è —Ö–æ—á—É —Å–º–æ—Ç—Ä–µ—Ç—å, –æ—Å—Ç–∞—ë—Ç—Å—è –ª–∏ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ responsive –ø–æ–∫–∞ —è –ø–æ–¥–≥—Ä—É–∂–∞—é —Å–∫—Ä–∏–ø—Ç—ã –∏ —Å—Ç–∏–ª–∏ (–ø—Ä–æ—Å—Ç–æ –Ω–∞ —á—ë—Ä–Ω–æ–º –Ω–µ –≤–∏–¥–Ω–æ —á—ë—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç –º–æ–µ–≥–æ —Å—á—ë—Ç—á–∏–∫–∞ (–∫–æ—Ä–æ—á–µ –∑–∞–±–µ–π)).

–ü–æ—Å–ª–µ —Å—Ç–∏–ª–µ–π –≤–∏–¥–Ω–æ –¥–∞–Ω–Ω—ã–π –¥–∂–∞–≤–∞—Å–∫—Ä–∏–ø—Ç:
```js
const SCRIPTS = [
  "https://ahfarmer.github.io/calculator/static/js/main.b319222a.js",
]
const CSS = [
  "https://ahfarmer.github.io/calculator/static/css/main.b51b4a8b.css",
]

function embedScript(mount, src) {
  const tag = document.createElement("script")
  tag.src = src
  return mount.appendChild(tag)
}
function embedCSS(mount, src) {
  const tag = document.createElement("link")
  tag.rel = "stylesheet"
  tag.href = src
  return mount.appendChild(tag)
}
function tryToLoadSPA() {
  setTimeout(loadSPA, 1000)
}
function loadSPA() {
  const mount = document.getElementsByTagName("head")[0]
  SCRIPTS.map(src => embedScript(mount, src))
  CSS.map(src => embedCSS(mount, src))
}
```

–ü–æ —Å—É—Ç–∏ —Ç—É—Ç —Å–æ–∑–¥–∞—ë—Ç—Å—è –≥–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è *tryToLoadSPA*, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å –±–æ–ª—å—à–æ–µ SPA –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ–ø–∏—Ä–∞—è—Å—å –Ω–∞ –∫–∞–∫—É—é-—Ç–æ –ª–æ–≥–∏–∫—É (—É –º–µ–Ω—è —Å—Ç–æ–∏—Ç —Ç–∞–π–º–∞—É—Ç –≤ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ü–µ–ª—è—Ö). –¢—É–¥–∞ –º–æ–∂–Ω–æ –ø–æ—Å—Ç–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ *performance*, —á—Ç–æ–±—ã –≥—Ä—É–∑–∏—Ç—å SPA –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç FCP –∏–ª–∏ TTI –∏–ª–∏ –µ—â—ë —á–µ–≥–æ —É–≥–æ–¥–Ω–æ... –ú–æ–∂–Ω–æ –Ω–∞ —ç—Ç–æ–º –º–æ–º–µ–Ω—Ç–µ –¥–µ–ª–∞—Ç—å –≤—Å–ø–ª—ã–≤–∞—é—â–µ–µ –æ–∫–Ω–æ, –≤ –∫–æ—Ç–æ—Ä–æ–º —Å–ø—Ä–∞—à–∏–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ –æ–Ω —Ö–æ—á–µ—Ç –∑–∞–≥—Ä—É–∑–∏—Ç—å **—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é —Å–∞–π—Ç–∞**. –í –æ–±—â–µ–º —Å—É—Ç—å –ø–æ–Ω—è—Ç–Ω–∞. –ö–æ—Å—Ç—ã–ª–∏ –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ js–∞ –∏ css–æ–∫ —è –≤–∑—è–ª —Å [stackoverflow](https://stackoverflow.com/questions/19737031/loading-scripts-after-page-load).

–ù—É –∏ –∑–∞–∫–ª—é—á–∞—é—â–∏–π –∫—É—Å–æ–∫ - —É–∂–µ –±–æ—Ä–æ–¥–∞—Ç—ã–π counter:
```html
<div id="root" v-scope="{num: 0}" v-cloak @mounted="tryToLoadSPA">
  {{ num }} <button @click="num++">+</button>
</div>
```

–ï—Å–ª–∏ –≤–¥—Ä—É–≥ –≤–ø–µ—Ä–≤—ã–µ –≤–∏–¥–∏—à—å *v-scope* - —ç—Ç–æ —Ñ–∏—á–∞ –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ petite-vue. –ü–æ —Å—É—Ç–∏ —Ç—ã –∑–∞–¥–∞—ë—à—å *$data* –ø–æ–ª–µ, –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—è –¥–æ—á–µ—Ä–Ω—é—é —á–∞—Å—Ç—å DOM –¥–µ—Ä–µ–≤–∞ –∫–∞–∫ Vue –∫–æ–º–ø–æ–Ω–µ–Ω—Ç (–ø–æ–¥—Ä–æ–±–Ω–µ–µ –≤ —Å—Ç–∞—Ç—å–µ x).
–¢—É—Ç –∂–µ –æ—á–µ—Ä–µ–¥–Ω–∞—è —ç–∫—Å–∫–ª—é–∑–∏–≤–Ω–∞—è —à—Ç—É–∫–∞ - *@mounted*. –≠—Ç–æ –¥–∏—Ä–µ–∫—Ç–∏–≤–∞, –∫–æ—Ç–æ—Ä–∞—è –∏—Å–ø–æ–ª–Ω–∏—Ç JS –∫–æ–¥ –∫–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –±—É–¥–µ—Ç –∑–∞–º–∞—É–Ω—Ç–µ–Ω (–≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ —Ç–æ–ª—å–∫–æ 1 —Ä–∞–∑). –í –æ–±—ã—á–Ω–æ–º Vue —ç—Ç–æ –ø–æ–ª–µ *mounted* —Å—Ç—Ä—É–∫—Ç—É—Ä–∫–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞. –ü–æ –∞–Ω–∞–ª–æ–≥–∏–∏ —Å –¥—Ä—É–≥–∏–º–∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏ –¥–∏—Ä–µ–∫—Ç–∏–≤ –º–æ–∂–µ—Ç –ø–æ–∫–∞–∑–∞—Ç—å—Å—è, —á—Ç–æ –µ—Å—Ç—å event *onmounted*, –Ω–æ —ç—Ç–æ –Ω–µ —Ç–∞–∫ - —Ç–æ–ª—å–∫–æ petite-vue –º–æ–∂–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å/–ø–æ—Å–ª–∞—Ç—å —ç—Ç–æ —Å–æ–±—ã—Ç–∏–µ. –¢–æ—á–Ω–æ —Ç–∞–∫–∂–µ –µ—Å—Ç—å —Å–æ–±—ã—Ç–∏–µ *@unmounted*, –∫–æ—Ç–æ—Ä–æ–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–æ–≥–¥–∞ —ç–ª–µ–º–µ–Ω—Ç —É–¥–∞–ª—è–µ—Ç—Å—è –∏–∑ –¥–µ—Ä–µ–≤–∞.

–ó–∞–º–µ—Ç–∏–º, —á—Ç–æ –¥–∞–Ω–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –∏–º–µ–µ—Ç *id="root"*. –≠—Ç–æ –Ω–µ —Å–ª—É—á–∞–π–Ω–æ - –∫–æ–≥–¥–∞ –ø—Ä–∏–¥—ë—Ç React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –æ–Ω–æ –ø–µ—Ä–µ—Ç—Ä—ë—Ç –≤—Å—ë —á—Ç–æ –º—ã –ø–∏—à–µ–º –Ω–∞ petite-vue –∏ –Ω–µ –≤–æ–∑–Ω–∏–∫–Ω–µ—Ç –Ω–∏–∫–∞–∫–∏—Ö –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤.

–î–∞–≤–∞–π –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –ø–æ–ª—É—á–∏–≤—à–∏–π—Å—è –≥—Ä–∞—Ñ–∏–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
![](./diagram.png)

## v-effect
–ö–æ–Ω–µ—á–Ω–æ, —Å—Ç–æ–∏—Ç —Å–æ–≥–ª–∞—Å–∏—Ç—å—Å—è, —á—Ç–æ –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–º –ø—Ä–∏–º–µ—Ä–µ –º—ã –ø–æ–ª—É—á–∏–ª–∏ –æ—á–µ–Ω—å –º–æ—â–Ω—ã–π —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç –¥–ª—è progressive –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –Ω–æ —è –≤—Å—ë-—Ç–∞–∫–∏ –Ω–µ —Å–æ–≥–ª–∞—à—É—Å—å. –ü–µ—Ä–≤—ã–π –≤–æ–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∫–∞–∂–µ—Ç –Ω–µ—Å–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã - —è –∏—Å–ø–æ–ª—å–∑—É—é –∫–æ–ª–±–µ–∫ *@mounted*, –∞ —á—Ç–æ –µ—Å–ª–∏ –æ–Ω —É–∂–µ –±—É–¥–µ—Ç –∑–∞–Ω—è—Ç???

–î–∞–≤–∞–π –ø–æ–ø—Ä–æ–±—É–µ–º –ø—Ä–∏–¥—É–º–∞—Ç—å —Ä–µ—à–µ–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é –µ—â—ë –æ–¥–Ω–æ–≥–æ —ç–∫—Å–∫–ª—é–∑–∏–≤–∞ Petite-vue *v-effect*. –≠—Ç–æ –æ—á–µ–Ω—å –º–æ—â–Ω–∞—è –¥–∏—Ä–µ–∫—Ç–∏–≤–∞, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª–Ω—è—Ç—å —Ä–µ–∞–∫—Ç–∏–≤–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã.

–ï—Å–ª–∏ —Ç—ã –∑–Ω–∞–µ—à—å –ø—Ä–æ *useEffect* –∏–∑ React–∞, —Ç–æ *v-effect* —ç—Ç–æ —Ç–∞–∫–æ–π *useEffect* –Ω–∞ –º–∏–Ω–∏–º–∞–ª–∫–∞—Ö, –∫–æ—Ç–æ—Ä—ã–π —Å–∞–º –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –º–∞—Å—Å–∏–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∏ –ø—Ä–æ–≥–æ–Ω—è–µ—Ç –∏–Ω–ª–∞–π–Ω —Å–∫—Ä–∏–ø—Ç –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–∞–∫–æ–π-—Ç–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏. –î–∞–≤–∞–π –ø–æ—Å–º–æ—Ç—Ä–∏–º [–ø—Ä–∏–º–µ—Ä –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏](https://github.com/vuejs/petite-vue#v-effect):
```html
<div v-scope="{ count: 0 }">
  <div v-effect="$el.textContent = count"></div>
  <button @click="count++">++</button>
</div>
```

–¢—É—Ç –º–∞—Å—Å–∏–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (–≤—Ö–æ–¥–Ω—ã–µ/–≤–Ω–µ—à–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ) –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–∞–∫ *[ $data.count ]* –∏ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —ç—Ç–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π —Å–∫—Ä–∏–ø—Ç–∏–∫ *$el.textContent = count* –±—É–¥–µ—Ç —Å–Ω–æ–≤–∞ –∏ —Å–Ω–æ–≤–∞ –∏—Å–ø–æ–ª–Ω—è—Ç—å—Å—è.

–î–∞–≤–∞–π —Ç–µ–ø–µ—Ä—å –ø—Ä–∏–º–µ–Ω–∏–º —ç—Ç–æ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –Ω–∞—à–µ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞:
```html
<div
  id="root"
  v-scope="{num: 0}"
  v-cloak
  v-effect="tryToLoadSPA()"
  @mounted="console.log('hi')"
>
  {{ num }} <button @click="num++">+</button>
</div>
```

–¢–µ–ø–µ—Ä—å –º—ã –ø–æ–ª—É—á–∏–ª–∏ —Ç–æ—Ç –∂–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç, —á—Ç–æ –∏ –≤ –ø–µ—Ä–≤–æ–º —Ä–µ—à–µ–Ω–∏–∏, –Ω–æ –∏–º–µ–µ–º —Å–≤–æ–±–æ–¥–Ω—ã–π –∫–æ–ª–±–µ–∫ –¥–ª—è *@mounted*.


–ú–æ–∂–Ω–æ —É–¥–æ—Å—Ç–æ–≤–µ—Ä–∏—Ç—Å—è —á—Ç–æ —ç—Ç–æ—Ç –ø—Ä–∏–º–µ—Ä —Ä–∞–±–æ—á–∏–π –Ω–∞ [—Å—Ç—Ä–∞–Ω–∏—Ü–µ](https://nottgy.github.io/einstain/petite-vue-example/progressive-enchancement/veffect.html).

## –ö–∞—Å—Ç–æ–º–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–∏–≤—ã
–ù—É –∞ —á—Ç–æ –µ—Å–ª–∏ —è —Ö–æ—á—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏ *v-effect* –∏ *@mounted*??? –ù–µ—É–∂–µ–ª–∏ –≤—Å—ë-—Ç–∞–∫–∏ –ø—Ä–∏–¥—ë—Ç—Å—è –ø–∏—Å–∞—Ç—å –∫–æ—Å—Ç—ã–ª—å–Ω–æ? –ê —á—Ç–æ –µ—Å–ª–∏ —è —Ö–æ—á—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–±–∏—Ä–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∞ –Ω–µ –ø—Ä–æ–ø–∏—Å—ã–≤–∞—Ç—å –∫–∞–∂–¥—ã–π —Ä–∞–∑ entrypoint—ã –≤—Ä—É—á–Ω—É—é –ø—Ä—è–º–æ –≤ –î–∂–∞–≤–∞—Å–∫—Ä–∏–ø—Ç–µ?

–í —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –∫–∞—Å—Ç–æ–º–Ω—É—é –¥–∏—Ä–µ–∫—Ç–∏–≤—É. –í –æ–±—ã—á–Ω–æ–º Vue —ç—Ç–æ —Ç–æ–∂–µ –≤–æ–∑–º–æ–∂–Ω–æ, –Ω–æ —Ç–∞–º, –æ—á–µ–≤–∏–¥–Ω–æ, –¥—Ä—É–≥–æ–π –Ω–∞–±–æ—Ä –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π :). –í –æ–±—â–µ–º –¥–∞–≤–∞–π –ø–æ–ø—Ä–æ–±—É–µ–º —Å–¥–µ–ª–∞—Ç—å —Ö–æ—Ç—å —á—Ç–æ-—Ç–æ - –ø–æ—Ç–æ–º —Ä–∞–∑–±–µ—Ä—ë–º—Å—è.

```html
<title> Petite Vue Progressive Enchancement </title>
<style>
  [v-cloak] {display:none}
  body { background: #fff!important }
</style>

<script type="module">
  import { createApp } from "https://unpkg.com/petite-vue?module"

  const SCRIPTS = [
    "https://ahfarmer.github.io/calculator/static/js/main.b319222a.js",
  ]
  const CSS = [
    "https://ahfarmer.github.io/calculator/static/css/main.b51b4a8b.css",
  ]

  function embedScript(mount, src) {
    const tag = document.createElement("script")
    tag.src = src
    return mount.appendChild(tag)
  }
  function embedCSS(mount, src) {
    const tag = document.createElement("link")
    tag.href = src
    tag.rel = "stylesheet"
    return mount.appendChild(tag)
  }
  function tryToLoadSPA() {
    setTimeout(loadSPA, 1000)
  }
  function loadSPA() {
    const mount = document.getElementsByTagName("head")[0]
    SCRIPTS.map(src => embedScript(mount, src))
    CSS.map(src => embedCSS(mount, src))
  }

  function App() {
    return { num: 0 }
  }

  const progressiveDirective = (ctx) => {
    tryToLoadSPA()
  }

  createApp({ App, tryToLoadSPA })
    .directive('progressive', progressiveDirective)
    .mount()
</script>

<body>
  <div id="root" v-scope="App()" v-cloak v-progressive>
    {{ num }} <button @click="num++">+</button>
  </div>
</body>
```

–í–æ—Ç, –º—ã –∑–∞–º–µ–Ω–∏–ª–∏ *v-effect* –∏ *@mounted* –Ω–∞ *v-progressive*. –≠—Ç–æ –¥–∏—Ä–µ–∫—Ç–∏–≤–∞, –∫–æ—Ç–æ—Ä—É—é –º—ã –¥–æ–±–∞–≤–∏–ª–∏ –≤–æ—Ç —Ç–∞–∫:
```js
const progressiveDirective = (ctx) => {
  tryToLoadSPA()
}

createApp({ App, tryToLoadSPA })
  .directive('progressive', progressiveDirective)
  .mount()
```
–£ –Ω–∞—Å –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ–π —Å–ª—É—á–∞–π - –Ω–∞–º –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª–Ω–∏—Ç—å —á—Ç–æ-—Ç–æ –Ω–∞ mount–µ —ç–ª–µ–º–µ–Ω—Ç–∞, –∫ –∫–æ—Ç–æ—Ä–æ–º—É –ø—Ä–∏–≤—è–∑–∞–Ω–∞ –¥–∏—Ä–µ–∫—Ç–∏–≤–∞, –ø–æ—ç—Ç–æ–º—É –º—ã –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º *ctx* –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–π –¥–∏—Ä–µ–∫—Ç–∏–≤–µ, –∞ –ø—Ä–æ—Å—Ç–æ –≤—ã–∑—ã–≤–∞–µ–º —Ç–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—É—é —Ñ—É–Ω–∫—Ü–∏—é.
–ù–æ –≤ *ctx* –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –∫—É—á–∞ –ø–æ–ª–µ–∑–Ω–æ—Å—Ç–µ–π ([–∏–∑ –¥–æ–∫–∏](https://github.com/vuejs/petite-vue#custom-directives)):
```js
const myDirective = (ctx) => {
  // —ç–ª–µ–º–µ–Ω—Ç, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–≤—è–∑–∞–Ω–∞ –¥–∏—Ä–µ–∫—Ç–∏–≤–∞
  ctx.el

  // –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –ø–µ—Ä–µ–¥–∞—é—â–µ–µ—Å—è –≤ –¥–∏—Ä–µ–∫—Ç–∏–≤—É
  // –¥–ª—è v-my-dir="x" —ç—Ç–æ –±—É–¥–µ—Ç "x"
  ctx.exp

  // –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞—Ä–≥—É–º–µ–Ω—Ç —á–µ—Ä–µ–∑ ":"
  // v-my-dir:foo -> "foo"
  ctx.arg

  // –º–∞—Å—Å–∏–≤ –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤
  // v-my-dir.mod -> { mod: true }
  ctx.modifiers

  // –º–æ–∂–Ω–æ –≤—ã—á–∏—Å–ª–∏—Ç—å –≤—ã—Ä–∞–∂–µ–Ω–∏–µ ctx.exp
  ctx.get()

  // –º–æ–∂–Ω–æ –≤—ã—á–∏—Å–ª–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ
  ctx.get(`${ctx.exp} + 10`)

  ctx.effect(() => {
    // —ç—Ç–æ –∞–Ω–∞–ª–æ–≥ v-effect, –±—É–¥–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∑–Ω–∞—á–µ–Ω–∏—è ctx.get()
    console.log(ctx.get())
  })

  return () => {
    // –∫–æ–ª–±–µ–∫, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ unmount–µ —ç–ª–µ–º–µ–Ω—Ç–∞
  }
}

// –¥–æ–±–∞–≤–ª—è–µ–º –¥–∏—Ä–µ–∫—Ç–∏–≤—É –∫ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏ petite-vue
createApp().directive('my-dir', myDirective).mount()
```

–ú–æ–∂–Ω–æ —É—Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ–≤–∞—Ç—å –Ω–∞—à –ø—Ä–∏–º–µ—Ä –µ—Å–ª–∏ –Ω–µ —Ö–∞—Ä–¥–∫–æ–¥–∏—Ç—å –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã *SCRIPTS* –∏ *CSS*, –∞ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –≤–Ω—É—Ç—Ä—å –¥–∏—Ä–µ–∫—Ç–∏–≤—ã *v-progressive* –º–∞—Å—Å–∏–≤ entrypoint–æ–≤ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—Å—ë –ø–∞—Ä—Å–∏—Ç—å –∏ –ø–æ–¥–≥—Ä—É–∂–∞—Ç—å (css–∫–∏ –æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç js–∞). –ù–æ —ç—Ç–æ –æ—á–µ–Ω—å –º–Ω–æ–≥–æ –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ —Ö–æ—á–µ—Ç—Å—è –ø—Ä–æ—Å—Ç–æ –≤—Å—Ç–∞–≤–ª—è—Ç—å —Å—é–¥–∞ - –∏–¥–µ—è –ø–æ–Ω—è—Ç–Ω–∞ :).

## –ö–∞—Å—Ç–æ–º–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç–µ–ª–∏

–í—Ä–æ–¥–µ —Ä–∞–∑–æ–±—Ä–∞–ª–∏—Å—å —Å–æ –≤—Å–µ–º —á—Ç–æ –∫–∞—Å–∞–µ—Ç—Å—è —Ä–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç–∏, —Ç–µ–ø–µ—Ä—å –Ω–∞–º–µ—Ç–∏–ª–∞—Å—å –µ—â—ë –æ–¥–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞: —è –∏—Å–ø–æ–ª—å–∑—É—é mustache/handlebars/jinja/–µ—â—ë —á—Ç–æ-—Ç–æ –≥–¥–µ —É–∂–µ –µ—Å—Ç—å –æ–≥—Ä–∞–Ω–∏—á–∏—Ç–µ–ª–∏ *{{* –∏ *}}*.

–í —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –æ–≥—Ä–∞–Ω–∏—á–∏—Ç–µ–ª–∏ petite-vue, –ø–µ—Ä–µ–¥–∞–≤...
```js
createApp({
  $delimiters: ['$<', '>$']
}).mount()
```
–ù–∞ –º–µ—Å—Ç–µ *$<* –∏ *>$* –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —á—Ç–æ —É–≥–æ–¥–Ω–æ. –õ—É—á—à–µ —á—Ç–æ–±—ã –¥–ª–∏–Ω–∞ –±—ã–ª–∞ –ø–æ–∫–æ—Ä–æ—á–µ –∏ –≤ —à–∞–±–ª–æ–Ω–µ —Ç–∞–∫–∏–µ —Å–∏–º–≤–æ–ª—ã –≤—Å—Ç—Ä–µ—á–∞–ª–∏—Å—å –Ω–µ —Å–ª–∏—à–∫–æ–º —á–∞—Å—Ç–æ (–Ω—É–∂–Ω–æ –ø–æ–¥—É–º–∞—Ç—å –æ —Å–∫–æ—Ä–æ—Å—Ç–∏ –ø–æ–∏—Å–∫–∞ –≤ —Å—Ç—Ä–æ–∫–µ :) ).

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ.min.js

–ù–µ —Ö–æ—á—É —á—Ç–æ-—Ç–æ —Ç—É—Ç –ø–∏—Å–∞—Ç—å, –ø–æ—Ç–æ–º—É —á—Ç–æ —Ä–∞—Å—Å–∫–∞–∑–∞–ª –Ω–µ –ø—Ä–æ –≤—Å—ë —á—Ç–æ –µ—Å—Ç—å –≤ petite-vue. –û–¥–Ω–∞–∫–æ —Ä–∞—Å—Å–∫–∞–∑–∞–ª –æ–±–æ –≤—Å–µ—Ö —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö (–æ—Ç–ª–∏—á–∏—Ç–µ–ª—å–Ω—ã—Ö –æ—Ç Vue) –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—è—Ö, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∑–≤–æ–ª—è—é—Ç —Å—Ç—Ä–æ–∏—Ç—å—Å—è –ø—Ä—è–º–æ –ø–æ–≤–µ—Ä—Ö DOM–∞ –±—ã—Å—Ç—Ä–µ–µ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ. –í –æ–±—â–µ–º –Ω–æ—Ä–º–∞–ª—å–Ω–æ... 

–ú–æ–∏ –ø—Ä–∏–º–µ—Ä—ã –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å [—Ç—É—Ç](https://github.com/notTGY/einstain/tree/master/petite-vue-example/progressive-enchancement).
