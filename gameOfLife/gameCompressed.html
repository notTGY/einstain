<body style=margin:0>
    <canvas id="c">
    <script>
    onload=_=>{
        f=[];
        S=20;
        d=_=>{
            for(i=0;i<S*S;i++){
                    X.fillStyle=f[i]?'red':'tan';
                    X.fillRect(i%S*S,i-i%S,S,S)
            }
        };
        G=_=>{
            p=[...f];
            for(i=0;i<S*S;i++){
                    for(n=j=0;j<9;j++){
                        x=j%3-1;
                        if(p[((i-i%S)/S+(j-x-1)/3-1+S)%S*S+(x+i%S+S)%S])
                                j!=4&&n++;
                        }

                    k=false;
                    if(n<2)f[i]=k;
                    if(n>3)f[i]=k;
                    if(n==3)f[i]=!k;
                }
            d();
            setTimeout(G,500)
        };
        onmousedown=e=>{
            if(e.which==2)G();
                else I=Math.floor(e.y/S)*S+Math.floor(e.x/S),f[I]=!f[I],d()
        };
        c.width=c.height=S*S;
        X=c.getContext`2d`;
        d()
    }
    </script>